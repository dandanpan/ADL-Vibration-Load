init;

load('P1.mat');
repID = 2;
load(['/Users/shijiapan/Box Sync/Activity_Detection/0407/PortLab_20190407_Route_P1_Rep' num2str(repID) '.mat']);
% figure;plot(data(4,:));
% hold on;
% plot(data(4,:));hold on;
% for i = 1:length(Table{repID}.stepStartIdxArray)
%     plot([Table{repID}.stepStartIdxArray(i), Table{repID}.stepStartIdxArray(i)],[0,5],'g');
%     plot([Table{repID}.stepStopIdxArray(i), Table{repID}.stepStopIdxArray(i)],[0,5],'r');
% end
% hold off;


% Events
% 1. operating with kettle
% 2. kettle 
% 3. operating with microwave
% 4. microwave
% 5. put things on stove
% 6. operating with stove
% 7. stove
% 8. operating vacuum
% 9. sweep floor
% 10. walking/step
% 11. miscellaneous
% 12. sync
% 13. vacant
% 14. microwave door

labels{repID} = [7,8,8,20,12;...
          10,25,11,26,10;...
          13,25,14,15,5;...
          15,25,16,25,5;...
          17,10,17,30,10;...
          18,8,18,20,10;...
          18,26,19,10,10;...
          19,30,20,20,1;...
          20,20,26,21,2;...
          26,21,26,28,1;...
          27,18,27,30,10;...
          28,15,28,30,10;...
          29,10,29,30,10;...
          30,13,30,24,3;...
          30,24,32,28,14;...
          32,28,33,23,3;...
          34,18,35,8,10;...
          35,10,35,26,10;...
          35,28,36,15,10;...
          36,17,36,30,11;...
          39,10,41,20,11;...
          41,25,42,13,10;...
          42,15,43,5,10;...
          43,12,52,30,11;...
          53,28,54,25,10;...
          55,1,55,20,10;...
          55,23,56,5,10;...
          56,10,56,20,10;...
          56,26,57,5,10;...
          58,8,58,18,11;...
          59,1,59,18,10;...
          59,20,60,20,9;...
          61,10,62,12,9;...
          62,30,63,28,9;...
          63,28,64,14,10;...
          64,15,65,15,9;...
          66,8,67,7,9;...
          67,25,68,14,9;...
          69,7,69,23,10;...
          69,30,70,10,10;...
          72,5,72,30,10;...
          74,18,75,20,10;...
          75,22,89,1,8;...
          91,25,95,1,11
          ];

startindex = 6.5*10^4;
startindex_time = startindex/Fs;
starttime = labels{repID}(1,1)+labels{repID}(1,2)/30;
data_label = zeros(1,length(data));
label_index = [];
for eventID = 1:length(labels{repID})
    event_start_time = labels{repID}(eventID,1)+labels{repID}(eventID,2)/30;
    event_end_time = labels{repID}(eventID,3)+labels{repID}(eventID,4)/30;
    event_label = labels{repID}(eventID,5);
    event_start_index = round((event_start_time-starttime)*Fs+startindex);
    event_end_index = round((event_end_time-starttime)*Fs+startindex);
    data_label(event_start_index:event_end_index) = event_label;
    label_index = [label_index; event_start_index, event_end_index];
end

currentLabel = zeros(1,length(data));
tableLabel = zeros(1,length(data));
floorLabel = zeros(1,length(data));

for eventID = 1:length(Currents{repID}.stepStartIdxArray)
    currentLabel(Currents{repID}.stepStartIdxArray(eventID):Currents{repID}.stepStopIdxArray(eventID)) = -3;
end
for eventID = 1:length(Table{repID}.stepStartIdxArray)
    tableLabel(Table{repID}.stepStartIdxArray(eventID):Table{repID}.stepStopIdxArray(eventID)) = -4;
end
for eventID = 1:length(Floor{repID}.stepStartIdxArray)
    floorLabel(Floor{repID}.stepStartIdxArray(eventID):Floor{repID}.stepStopIdxArray(eventID)) = -5;
end
figure;plot(data(4,:));hold on;
plot(data(5,:));hold on;
plot(data(3,:));hold on;
plot(data_label);
plot(currentLabel);
plot(tableLabel);
plot(floorLabel);

Label{repID}.label_array = data_label;
Label{repID}.label_startend = labels{repID};
Label{repID}.label_index = label_index;
save('P1.mat','Currents','Table','Floor','Label');


%%

repID = 3;
load(['/Users/shijiapan/Box Sync/Activity_Detection/0407/PortLab_20190407_Route_P1_Rep' num2str(repID) '.mat']);
% figure;plot(data(4,:));

% Events
% 1. operating with kettle
% 2. kettle 
% 3. operating with microwave
% 4. microwave
% 5. put things on stove
% 6. operating with stove
% 7. stove
% 8. operating vacuum
% 9. sweep floor
% 10. walking/step
% 11. miscellaneous
% 12. sync
% 13. vacant
% 14. microwave door

labels{repID} = [4,15,5,30,12;...
           6,3,6,15,10;...
           6,20,7,10,10;...
           10,5,10,27,5;...
           12,3,13,10,5;...
           13,20,14,10,10;...
           14,15,15,5,10;...
           15,20,16,20,1;...
           16,20,22,29,2;...
           22,29,23,20,1;...
           25,5,25,25,10;...
           26,15,26,20,3;...
           26,20,29,10,14;...
           29,10,29,25,3;...
           31,3,31,23,10;...
           31,25,32,15,10;...
           32,20,33,2,10;...
           36,15,37,20,11;...
           39,21,40,5,10;...
           40,8,40,23,10;...
           40,25,50,1,11;...
           50,5,50,20,10;...
           50,23,51,10,10;...
           51,15,51,28,10;...
           52,1,52,15,10;...
           53,1,53,18,10;...
           53,25,54,15,10;...
           54,17,55,7,10;...
           55,12,56,10,9;...
%            56,11,56,30,10;...
           57,1,57,26,9;...
           58,22,59,16,9;...
%            59,17,60,3,10;...
           60,4,60,28,9;...
           61,15,62,11,9;...
           63,1,63,21,9;...
%            64,8,64,19,10;...
           64,20,65,25,9;...
           66,18,67,11,9;...
%            67,13,67,21,10;...
           67,22,72,30,11;...
           73,1,73,15,10;...
           73,20,74,10,11;...
           74,10,91,10,8
          ];
      
startindex = 7.35*10^4;
startindex_time = startindex/Fs;
starttime = labels{repID}(1,1)+labels{repID}(1,2)/30;
data_label = zeros(1,length(data));
label_index = [];
for eventID = 1:length(labels{repID})
    event_start_time = labels{repID}(eventID,1)+labels{repID}(eventID,2)/30;
    event_end_time = labels{repID}(eventID,3)+labels{repID}(eventID,4)/30;
    event_label = labels{repID}(eventID,5);
    event_start_index = round((event_start_time-starttime)*Fs+startindex);
    event_end_index = round((event_end_time-starttime)*Fs+startindex);
    data_label(event_start_index:event_end_index) = event_label;
    label_index = [label_index; event_start_index, event_end_index];
end

currentLabel = zeros(1,length(data));
tableLabel = zeros(1,length(data));
floorLabel = zeros(1,length(data));

for eventID = 1:length(Currents{repID}.stepStartIdxArray)
    currentLabel(Currents{repID}.stepStartIdxArray(eventID):Currents{repID}.stepStopIdxArray(eventID)) = -3;
end
for eventID = 1:length(Table{repID}.stepStartIdxArray)
    tableLabel(Table{repID}.stepStartIdxArray(eventID):Table{repID}.stepStopIdxArray(eventID)) = -4;
end
for eventID = 1:length(Floor{repID}.stepStartIdxArray)
    floorLabel(Floor{repID}.stepStartIdxArray(eventID):Floor{repID}.stepStopIdxArray(eventID)) = -5;
end
close all
figure;plot(data(4,:));hold on;
plot(data(5,:));hold on;
plot(data(3,:));hold on;
plot(data_label);
plot(currentLabel);
plot(tableLabel);
plot(floorLabel);

Label{repID}.label_array = data_label;
Label{repID}.label_startend = labels{repID};
Label{repID}.label_index = label_index;
save('P1.mat','Currents','Table','Floor','Label');

%%
repID = 4;
load(['/Users/shijiapan/Box Sync/Activity_Detection/0407/PortLab_20190407_Route_P1_Rep' num2str(repID) '.mat']);
% figure;plot(data(4,:));

% Events
% 1. operating with kettle
% 2. kettle 
% 3. operating with microwave
% 4. microwave
% 5. put things on stove
% 6. operating with stove
% 7. stove
% 8. operating vacuum
% 9. sweep floor
% 10. walking/step
% 11. miscellaneous
% 12. sync
% 13. vacant
% 14. microwave door

labels{repID} = [4,17,5,30,12;...
                 9,5,9,20,5;...
                 10,25,11,30,5;...
                 12,1,12,20,10;...
                 12,25,13,20,10;...
                 14,5,15,5,1;...
                 15,5,15,10,10;...
                 15,5,21,19,2;...
                 21,17,21,27,1;...
                 22,27,22,30,10;...
                 23,15,23,22,10;...
                 25,20,25,30,3;...
                 25,30,28,20,14;...
                 28,20,29,20,3;...
                 30,5,30,25,10;...
                 31,1,31,25,10;...
                 31,27,33,3,11;...
                 35,2,35,10,11;...
                 35,20,36,20,10;...
                 36,25,37,15,10;...
                 37,20,38,8,10;...
                 38,18,39,2,10;...
                 39,2,48,1,11;...
                 49,10,49,25,10;...
                 50,1,50,20,10;...
                 50,25,51,8,10;...
                 51,12,51,25,10;...
                 52,1,52,10,10;...
                 53,4,53,20,10;...
                 53,25,54,15,10;...
                 54,21,55,13,9;...
                 56,2,56,22,9;...
                 57,14,57,30,9;...
                 58,23,59,5,9;...
                 59,25,60,12,9;...
                 61,2,61,23,9;...
                 61,25,64,25,10;...
                 64,27,86,30,8;...
          ];
      
startindex = 5.55*10^4;
startindex_time = startindex/Fs;
starttime = labels{repID}(1,1)+labels{repID}(1,2)/30;
data_label = zeros(1,length(data));
label_index = [];
for eventID = 1:length(labels{repID})
    event_start_time = labels{repID}(eventID,1)+labels{repID}(eventID,2)/30;
    event_end_time = labels{repID}(eventID,3)+labels{repID}(eventID,4)/30;
    event_label = labels{repID}(eventID,5);
    event_start_index = round((event_start_time-starttime)*Fs+startindex);
    event_end_index = round((event_end_time-starttime)*Fs+startindex);
    data_label(event_start_index:event_end_index) = event_label;
    label_index = [label_index; event_start_index, event_end_index];
end
data_label(2.22*10^6:end) = 10;

currentLabel = zeros(1,length(data));
tableLabel = zeros(1,length(data));
floorLabel = zeros(1,length(data));

for eventID = 1:length(Currents{repID}.stepStartIdxArray)
    currentLabel(Currents{repID}.stepStartIdxArray(eventID):Currents{repID}.stepStopIdxArray(eventID)) = -3;
end
for eventID = 1:length(Table{repID}.stepStartIdxArray)
    tableLabel(Table{repID}.stepStartIdxArray(eventID):Table{repID}.stepStopIdxArray(eventID)) = -4;
end
for eventID = 1:length(Floor{repID}.stepStartIdxArray)
    floorLabel(Floor{repID}.stepStartIdxArray(eventID):Floor{repID}.stepStopIdxArray(eventID)) = -5;
end
close all
figure;plot(data(4,:));hold on;
plot(data(5,:));hold on;
plot(data(3,:));hold on;
plot(data_label);
plot(currentLabel);
plot(tableLabel);
plot(floorLabel);

Label{repID}.label_array = data_label;
Label{repID}.label_startend = labels{repID};
Label{repID}.label_index = label_index;
save('P1.mat','Currents','Table','Floor','Label');


%%

repID = 5;
load(['/Users/shijiapan/Box Sync/Activity_Detection/0407/PortLab_20190407_Route_P1_Rep' num2str(repID) '.mat']);
% figure;plot(data(4,:));

% Events
% 1. operating with kettle
% 2. kettle 
% 3. operating with microwave
% 4. microwave
% 5. put things on stove
% 6. operating with stove
% 7. stove
% 8. operating vacuum
% 9. sweep floor
% 10. walking/step
% 11. miscellaneous
% 12. sync
% 13. vacant
% 14. microwave door

labels{repID} = [3,15,4,24,12;...
                9,3,9,23,5;...
                10,20,11,7,5;...
                12,10,13,5,10;...
                13,10,13,30,10;...
                14,29,15,28,1;...
%                 15,23,15,28,10;...
                15,28,22,8,2;...
                22,8,22,18,1;...
                24,15,25,15,10;...
                26,7,26,25,3;...
                26,25,29,1,14;...
                29,1,29,25,3;...
                30,15,31,15,10;...
                31,20,32,9,10;...
                32,1,32,25,11;...
                35,14,35,20,11;...
                36,5,37,20,10;...
                38,1,38,30,10;...
                39,1,45,30,11;...
                46,15,46,25,10;...
                47,1,47,25,10;...
                48,1,48,18,10;...
                48,22,49,5,10;...
                49,10,49,25,10;...
                49,29,50,10,10;...
                50,17,50,29,10;...
                51,13,52,10,10;...
                52,11,53,10,9;...
                53,15,53,25,10;...
                54,4,54,26,9;...
                55,7,55,17,10;...
                55,27,56,16,9;...
                57,12,57,30,9;...
                58,23,59,10,9;...
                60,6,60,24,9;...
                61,20,62,18,9;...
                62,27,63,15,10;...
                63,25,64,10,10;...
                64,15,64,25,10;...
                65,1,81,12,8;...
                83,28,84,10,10;...
                84,22,85,5,10;...
                85,10,85,28,10;...
                86,1,86,16,10;...
                86,18,87,3,10;...
                87,10,87,26,10;...
                88,1,88,15,10;...
                88,16,88,30,10;...
                89,5,89,20,10;...
                89,24,90,8,10;...
                90,12,90,30,10;...
                91,7,91,15,10;...
                91,29,92,4,10;...
                92,17,92,26,10;...
                93,16,93,23,10;...
                94,10,94,20,10;...
                95,1,95,7,10;...
                95,27,96,4,10;...
                96,23,96,28,10
          ];
      
startindex = 6*10^4;
startindex_time = startindex/Fs;
starttime = labels{repID}(1,1)+labels{repID}(1,2)/30;
data_label = zeros(1,length(data));
label_index = [];
for eventID = 1:length(labels{repID})
    event_start_time = labels{repID}(eventID,1)+labels{repID}(eventID,2)/30;
    event_end_time = labels{repID}(eventID,3)+labels{repID}(eventID,4)/30;
    event_label = labels{repID}(eventID,5);
    event_start_index = round((event_start_time-starttime)*Fs+startindex);
    event_end_index = round((event_end_time-starttime)*Fs+startindex);
    data_label(event_start_index:event_end_index) = event_label;
    label_index = [label_index; event_start_index, event_end_index];
end

currentLabel = zeros(1,length(data));
tableLabel = zeros(1,length(data));
floorLabel = zeros(1,length(data));

for eventID = 1:length(Currents{repID}.stepStartIdxArray)
    currentLabel(Currents{repID}.stepStartIdxArray(eventID):Currents{repID}.stepStopIdxArray(eventID)) = -3;
end
for eventID = 1:length(Table{repID}.stepStartIdxArray)
    tableLabel(Table{repID}.stepStartIdxArray(eventID):Table{repID}.stepStopIdxArray(eventID)) = -4;
end
for eventID = 1:length(Floor{repID}.stepStartIdxArray)
    floorLabel(Floor{repID}.stepStartIdxArray(eventID):Floor{repID}.stepStopIdxArray(eventID)) = -5;
end
close all
figure;plot(data(4,:));hold on;
plot(data(5,:));hold on;
plot(data(3,:));hold on;
plot(data_label);
plot(currentLabel);
plot(tableLabel);
plot(floorLabel);

Label{repID}.label_array = data_label;
Label{repID}.label_startend = labels{repID};
Label{repID}.label_index = label_index;
save('P1.mat','Currents','Table','Floor','Label');

%%
repID = 6;
load(['/Users/shijiapan/Box Sync/Activity_Detection/0407/PortLab_20190407_Route_P1_Rep' num2str(repID) '.mat']);
% figure;plot(data(4,:));

% Events
% 1. operating with kettle
% 2. kettle 
% 3. operating with microwave
% 4. microwave
% 5. put things on stove
% 6. operating with stove
% 7. stove
% 8. operating vacuum
% 9. sweep floor
% 10. walking/step
% 11. miscellaneous
% 12. sync
% 13. vacant
% 14. microwave door

labels{repID} = [6,24,8,4,12;...
                 11,1,11,15,5;...
                 13,8,13,28,5;...
                 14,15,15,5,10;...
                 15,10,15,26,10;...
                 15,28,16,13,10;...
                 17,2,18,1,1;...
%                  17,29,18,4,10;...
                 18,1,26,28,2;...
                 26,28,27,8,1;...
                 31,14,31,28,3;...
                 31,28,34,20,14;...
                 34,20,35,20,3;...
                 36,15,37,10,10;...
                 37,13,37,30,10;...
                 39,25,40,30,11;...
                 41,10,42,15,10;...
                 42,25,43,15,10;...
                 43,15,51,5,11;...
                 51,20,52,16,10;...
                 52,25,53,10,10;...
                 53,15,53,30,10;...
                 54,1,54,15,10;...
                 54,20,55,15,10;...
                 56,5,56,20,10;...
                 56,25,57,23,9;...
                 58,1,58,15,10;...
                 58,18,59,16,9;...
                 59,23,60,6,10;...
                 60,8,61,4,9;...
                 61,25,62,16,9;...
                 63,15,64,6,9;...
                 64,27,65,16,9;...
                 65,20,66,25,10;...
                 67,4,67,14,10;...
                 67,28,68,8,10;...
                 68,28,90,15,8;...
                 90,15,93,10,11;...
                 93,10,93,25,10;...
                 94,1,94,15,10;...
                 94,25,95,5,10
          ];
      
startindex = 3.8*10^4;
startindex_time = startindex/Fs;
starttime = labels{repID}(1,1)+labels{repID}(1,2)/30;
data_label = zeros(1,length(data));
label_index = [];
for eventID = 1:length(labels{repID})
    event_start_time = labels{repID}(eventID,1)+labels{repID}(eventID,2)/30;
    event_end_time = labels{repID}(eventID,3)+labels{repID}(eventID,4)/30;
    event_label = labels{repID}(eventID,5);
    event_start_index = round((event_start_time-starttime)*Fs+startindex);
    event_end_index = round((event_end_time-starttime)*Fs+startindex);
    data_label(event_start_index:event_end_index) = event_label;
    label_index = [label_index; event_start_index, event_end_index];
end

currentLabel = zeros(1,length(data));
tableLabel = zeros(1,length(data));
floorLabel = zeros(1,length(data));

for eventID = 1:length(Currents{repID}.stepStartIdxArray)
    currentLabel(Currents{repID}.stepStartIdxArray(eventID):Currents{repID}.stepStopIdxArray(eventID)) = -3;
end
for eventID = 1:length(Table{repID}.stepStartIdxArray)
    tableLabel(Table{repID}.stepStartIdxArray(eventID):Table{repID}.stepStopIdxArray(eventID)) = -4;
end
for eventID = 1:length(Floor{repID}.stepStartIdxArray)
    floorLabel(Floor{repID}.stepStartIdxArray(eventID):Floor{repID}.stepStopIdxArray(eventID)) = -5;
end
close all
figure;plot(data(4,:));hold on;
plot(data(5,:));hold on;
plot(data(3,:));hold on;
plot(data_label);
plot(currentLabel);
plot(tableLabel);
plot(floorLabel);

Label{repID}.label_array = data_label;
Label{repID}.label_startend = labels{repID};
Label{repID}.label_index = label_index;
save('P1.mat','Currents','Table','Floor','Label');
